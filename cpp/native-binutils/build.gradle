// The ld executable in this case is produced by compileLinuxSgx<Debug|Release> depending on whether the flag -PnativeDebug is set or not.
// We do not always build ld with debug symbols because if the user sets -PnativeDebug, the build will depend on both the
// release and debug versions of linuxSgx, meaning the sdk will potentially be built twice.
String cmakeBuildType = project.hasProperty("nativeDebug") ? "Debug" : "Release"
String cppBuildDir = "${project(":cpp").buildDir}/$cmakeBuildType"

jar {
    dependsOn(":cpp:compileLinuxSgx$cmakeBuildType")
    String ldBuildDir = "$cppBuildDir/linux-sgx/src/linux-sgx/external/toolset/ubuntu20.04/ld"
    into "com/r3/conclave/binutils", {
        from(ldBuildDir) {
            include "ld"
        }
    }
}
