def cppBuildDir = project(":cpp").buildDir

subprojects {
    apply plugin: 'java'

    def type = name.drop("native-enclave-".size()).capitalize()
    tasks.getByName("jar") { Jar task ->
        task.dependsOn(":cpp:compileEnclave$type")
        def partialEnclaveBuildDir = "$cppBuildDir/$type/jvm-enclave-avian"
        task.into "com/r3/conclave/partial-enclave/$type", {
            from(partialEnclaveBuildDir) {
                include "jvm_enclave_avian"
            }
        }
    }
}
