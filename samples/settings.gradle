pluginManagement {
    repositories {
        maven {
            gradlePluginPortal()
            mavenCentral()
            jcenter()
            url = "https://software.r3.com/artifactory/sgxjvm"
            credentials {
                username = System.getenv('OBLIVIUM_MAVEN_USERNAME')
                password = System.getenv('OBLIVIUM_MAVEN_PASSWORD')
            }
        }
    }
    resolutionStrategy {
        if (System.getenv('USE_PUBLISHED_ARTIFACTS') == "true") {
            eachPlugin {
                if ( requested.id.id == 'com.r3.conclave.enclave') {
                    def version = System.getenv('PUBLISHED_ARTIFACTS_VERSION')
                    useModule("com.r3.conclave:com.r3.conclave.enclave:$version")
                }
            }
        }
    }
}

if (System.getenv('USE_PUBLISHED_ARTIFACTS') != "true") {
    includeBuild("..") {
        name = "sgxjvm"
    }
}

include ':protobuf-enclave'
//include ':signing-enclave'
//include ':end-to-end-test'
include ':djvm:djvm-enclave'
include ':djvm:djvm-host'
include ':djvm:djvm-common'
include ':djvm:user-code'
